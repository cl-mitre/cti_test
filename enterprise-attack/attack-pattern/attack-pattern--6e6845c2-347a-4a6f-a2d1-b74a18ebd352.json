{
    "type": "bundle",
    "id": "bundle--a75ab65b-9469-4ed5-87de-209c510615c8",
    "spec_version": "2.0",
    "objects": [
        {
            "type": "attack-pattern",
            "id": "attack-pattern--6e6845c2-347a-4a6f-a2d1-b74a18ebd352",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "created": "2018-01-16T16:13:52.465Z",
            "modified": "2018-06-27T14:18:47.700Z",
            "name": "LSASS Driver",
            "description": "The Windows security subsystem is a set of components that manage and enforce the security policy for a computer or domain. The Local Security Authority (LSA) is the main component responsible for local security policy and user authentication. The LSA includes multiple dynamic link libraries (DLLs) associated with various other security functions, all of which run in the context of the LSA Subsystem Service (LSASS) lsass.exe process.  (Citation: Microsoft Security Subsystem)\n\nAdversaries may target lsass.exe drivers to obtain execution and/or persistence. By either replacing or adding illegitimate drivers (e.g., DLL Side-Loading Mitigation or DLL Search Order Hijacking Mitigation), an adversary can achieve arbitrary code execution triggered by continuous LSA operations.",
            "kill_chain_phases": [
                {
                    "phase_name": "execution",
                    "kill_chain_name": "mitre-attack"
                },
                {
                    "phase_name": "persistence",
                    "kill_chain_name": "mitre-attack"
                }
            ],
            "external_references": [
                {
                    "external_id": "T1177",
                    "url": "https://attack.mitre.org/wiki/Technique/T1177",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://technet.microsoft.com/library/cc961760.aspx",
                    "description": "Microsoft. (n.d.). Security Subsystem Architecture. Retrieved November 27, 2017.",
                    "source_name": "Microsoft Security Subsystem"
                },
                {
                    "url": "https://technet.microsoft.com/library/dn408187.aspx",
                    "description": "Microsoft. (2014, March 12). Configuring Additional LSA Protection. Retrieved November 27, 2017.",
                    "source_name": "Microsoft LSA Protection Mar 2014"
                },
                {
                    "url": "https://msdn.microsoft.com/library/windows/desktop/ff919712.aspx",
                    "description": "Microsoft. (n.d.). Dynamic-Link Library Security. Retrieved November 27, 2017.",
                    "source_name": "Microsoft DLL Security"
                },
                {
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902",
                    "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
                    "source_name": "TechNet Autoruns"
                }
            ],
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_detection": "With LSA Protection enabled, monitor the event logs (Events 3033 and 3063) for failed attempts to load LSA plug-ins and drivers. (Citation: Microsoft LSA Protection Mar 2014)\n\nUtilize the Sysinternals Autoruns/Autorunsc utility (Citation: TechNet Autoruns) to examine loaded drivers associated with the LSA.\n\nUtilize the Sysinternals Process Monitor utility to monitor DLL load operations in lsass.exe. (Citation: Microsoft DLL Security)",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_data_sources": [
                "API monitoring",
                "DLL monitoring",
                "File monitoring",
                "Kernel drivers",
                "Loaded DLLs",
                "Process Monitoring"
            ],
            "x_mitre_permissions_required": [
                "Administrator",
                "SYSTEM"
            ],
            "x_mitre_contributors": [
                "Vincent Le Toux"
            ]
        }
    ]
}